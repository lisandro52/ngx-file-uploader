function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{D57K:function(e,t,n){"use strict";function i(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(t){o(t)}}function a(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}n.d(t,"a",(function(){return i}))},"aGB+":function(e,t,n){"use strict";var i=n("D57K"),r=n("kZht"),o=n("C05f"),s=n("ZTXN"),a=n("ROBh"),l=n("6uGs"),u=n("pBDD"),c=n("mW0F"),h=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){var n=new d(e),i=Object(c.a)(n,this.notifier);return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n}}]),e}(),d=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).seenValue=!1,n}return _inherits(t,e),_createClass(t,[{key:"notifyNext",value:function(e,t,n,i,r){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),t}(u.a),p=n("YtkY"),f=n("4e/d"),v=n("An66");n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return P})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return V})),n.d(t,"g",(function(){return B})),n.d(t,"h",(function(){return H})),n.d(t,"i",(function(){return N})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return M}));var _=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"uniqueID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}},{key:"isElement",value:function(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}},{key:"isString",value:function(e){return!("string"!=typeof e)}},{key:"extendValue",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=t[0],r=1;r<t.length;r++)void 0!==t[r]&&(i=t[r]);return i}}]),e}();return e._uniqueNumber=1,e.nextUID=function(){return(e._uniqueNumber++).toString()},e}(),y=function(){function e(t){_classCallCheck(this,e),_.isElement(t)?this._createFromFakePath(t.value):this._createFromObject(t)}return _createClass(e,[{key:"_createFromFakePath",value:function(e){this.lastModifiedDate=null,this.size=null,this.type="like/"+e.slice(e.lastIndexOf(".")+1).toLowerCase(),this.name=e.split(/(\\|\/)/g).pop()}},{key:"_createFromObject",value:function(e){this.lastModifiedDate=new Date(e.lastModified||e.lastModifiedDate.getTime()),this.size=e.size,this.type=e.type,this.name=e.name}}]),e}(),g={},k={total:0,loaded:0,percent:0,speed:0,speedToText:"0 bytes"},m=function(){function e(t,n,i){_classCallCheck(this,e),this._progress$=new o.a(0),this._speed$=new o.a(k),this.options=Object.assign({},g,n),this._speedDefault={},this._id=_.uniqueID(),this._isUploading=!1,this._isUploaded=!1,this._isSuccess=!1,this._isCancel=!1,this._isError=!1;var r=_.isElement(t),s=new y(r?t.files[0]:t);this._file=s,this._fileElement=r?t.files[0]:t,this._fileActive=!1,void 0!==i&&this.bindUploader(i)}return _createClass(e,[{key:"bindUploader",value:function(e){this._uploader=e;var t=this._uploader.addFile(this);this._setFileActive(t)}},{key:"bindOptions",value:function(e){var t,n=Object.assign(Object.assign({},this.options.formData),null===(t=e)||void 0===t?void 0:t.formData);this.options=Object.assign(Object.assign(Object.assign({},this.options),e),{formData:n})}},{key:"getUploader",value:function(){return this._uploader}},{key:"upload",value:function(){var e;try{e=this.getUploader()}catch(t){throw new Error("Couldn`t upload because uploader was not defined. ERR_MSG: "+t.message)}this._isUploading=!0;try{e.uploadFile(this)}catch(t){}}},{key:"cancel",value:function(){this._isUploading&&this.getUploader().cancelUploadFile(this)}},{key:"_cancel",value:function(){this._isUploading&&(this._isCancel=!0,this._isUploaded=!1,this._isUploading=!1)}},{key:"remove",value:function(){var e;try{e=this.getUploader()}catch(t){throw new Error("Couldn`t remove because uploader was not defined. ERR_MSG: "+t.message)}this._isUploading&&this.cancel(),e.removeFile(this),this._setFileActive(!1)}},{key:"isUploaded",value:function(){return this._isUploaded}},{key:"isUploading",value:function(){return this._isUploading}},{key:"canUpload",value:function(){return!(this._isUploaded||this._isUploading||this._isSuccess||this._isError)}},{key:"handleImageLoad",value:function(){this._imageLoad=!0}},{key:"onBeforeUpload",value:function(){}},{key:"onProgressSpeed",value:function(e){e=e}},{key:"onProgress",value:function(e){e=e}},{key:"onSuccess",value:function(e,t,n){e=e,t=t,n=n}},{key:"onError",value:function(e,t,n){e=e,t=t,n=n}},{key:"_onBeforeUpload",value:function(){this._isUploading=!0,this._isUploaded=!1,this._isSuccess=!1,this._isCancel=!1,this._isError=!1,this._progress$.next(0),this.onBeforeUpload()}},{key:"_onProgressFileSpeed",value:function(e){this._speed$.next(e),this.onProgressSpeed(e)}},{key:"_onProgress",value:function(e){this._progress$.next(e),this.onProgress(e)}},{key:"_onSuccess",value:function(e,t,n){this._isUploading=!1,this._isUploaded=!0,this._isSuccess=!0,this._isError=!1,this._response=e,this.onSuccess(e,t,n),this._uploader.options.removeBySuccess&&this.remove()}},{key:"_onError",value:function(e,t,n){this._isUploading=!1,this._isUploaded=!1,this._isSuccess=!1,this._isError=!0,this._response=e,this.onError(e,t,n)}},{key:"_setFileActive",value:function(e){this._fileActive=e}},{key:"protocol",set:function(e){this._protocol=e}},{key:"id",get:function(){return this._id}},{key:"progressPercent$",get:function(){return this._progress$.asObservable()}},{key:"progress$",get:function(){return this._speed$.asObservable()}},{key:"progress",get:function(){return this._progress$.getValue()}},{key:"element",get:function(){return this._fileElement}},{key:"object",get:function(){return this._file}},{key:"name",get:function(){return this._file.name}},{key:"type",get:function(){return this._file.type}},{key:"date",get:function(){return this._file.lastModifiedDate}},{key:"size",get:function(){return this._file.size}},{key:"inQueue",get:function(){return this._fileActive}},{key:"response",get:function(){return this._response}},{key:"success",get:function(){return this._isSuccess}},{key:"error",get:function(){return this._isError}}]),e}();function b(e){return["options","progressPercent$","progress$","handleImageLoad","canUpload","isUploading","isUploaded","remove","_cancel","cancel","upload","getUploader","onBeforeUpload","onProgressSpeed","onProgress","onSuccess","onError","_onBeforeUpload","_onProgressFileSpeed","_onProgress","_onSuccess","_onError"].every((function(t){return t in e}))}var F,w,U,C,x,E,S,A,O=((w=function(){function e(t,n){_classCallCheck(this,e),this.element=t,this.renderer=n,this.fileHoverStart=new r.n,this.fileHoverEnd=new r.n,this.fileAccepted=new r.n,this.fileRejected=new r.n,this._InputFile=null}return _createClass(e,[{key:"ngOnInit",value:function(){this._files=[],this.renderer.addClass(this.element.nativeElement,"drop-area")}},{key:"ngOnDestroy",value:function(){if(this._files.length>0){var e=!0,t=!1,n=void 0;try{for(var i,r=this._files[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;b(o)&&(o.isUploaded()||(o.cancel(),this.uploader.removeFile(o)))}}catch(s){t=!0,n=s}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}},{key:"onDragOver",value:function(e){if(null===this._InputFile){if(this._InputFile=this.getDataTransferObject(e),null===this._InputFile)return;this.renderer.addClass(this.element.nativeElement,"drop-enter"),this.renderer.setAttribute(this.element.nativeElement,"dropValueText","Drop now"),this.fileHoverStart.emit()}this.preventAndStopEventPropagation(e)}},{key:"onDragLeave",value:function(e){if(null!==this._InputFile){if(this.renderer.removeClass(this.element.nativeElement,"drop-enter"),this.renderer.setAttribute(this.element.nativeElement,"dropValueText",""),this._InputFile=null,e.currentTarget===this.element[0])return;this.fileHoverEnd.emit()}this.preventAndStopEventPropagation(e)}},{key:"onDrop",value:function(e){if(null!==this._InputFile){if(this.renderer.removeClass(this.element.nativeElement,"drop-enter"),this.renderer.setAttribute(this.element.nativeElement,"dropValueText",""),this.fileHoverEnd.emit(),this._InputFile=this.getDataTransferObject(e),0===this._InputFile.files.length)return void(this._InputFile=null);var t=this._InputFile.files;if(!this.hasFiles(this._InputFile.types))return;this.readFile(t),this.fileAccepted.emit(this._files),this._InputFile=null}this.preventAndStopEventPropagation(e)}},{key:"preventAndStopEventPropagation",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"readFile",value:function(e){for(var t,n=0;n<e.length;n++){var i=e[n];try{t=new m(i,this.fileOptions,this.uploader)}catch(r){throw this.fileRejected.emit(r),new Error("Something goes wrong e: "+r.message)}t.inQueue&&this._files.push(t)}}},{key:"getDataTransferObject",value:function(e){return e.dataTransfer?e.dataTransfer:e.originalEvent.dataTransfer}},{key:"hasFiles",value:function(e){return!!e&&(e.indexOf?-1!==e.indexOf("Files"):!!e.contains&&e.contains("Files"))}}]),e}()).\u0275fac=function(e){return new(e||w)(r.Jb(r.l),r.Jb(r.D))},w.\u0275dir=r.Eb({type:w,selectors:[["","ngxFile2Drop",""]],hostBindings:function(e,t){1&e&&r.Ub("dragover",(function(e){return t.onDragOver(e)}))("dragleave",(function(e){return t.onDragLeave(e)}))("drop",(function(e){return t.onDrop(e)}))},inputs:{fileOptions:"fileOptions",uploader:"uploader"},outputs:{fileHoverStart:"fileHoverStart",fileHoverEnd:"fileHoverEnd",fileAccepted:"fileAccepted",fileRejected:"fileRejected"}}),w),P=((F=function(){function e(){_classCallCheck(this,e),this.role="input",this.type="file",this.fileHoverStart=new r.n,this.fileHoverEnd=new r.n,this.fileAccepted=new r.n,this.fileRejected=new r.n,this._InputFile=null}return _createClass(e,[{key:"ngOnInit",value:function(){this._files=[]}},{key:"ngOnDestroy",value:function(){if(this._files.length>0){var e=!0,t=!1,n=void 0;try{for(var i,r=this._files[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;b(o)&&(o.isUploaded()||(o.cancel(),this.uploader.removeFile(o)))}}catch(s){t=!0,n=s}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}},{key:"onChange",value:function(e){this._InputFile=this.getEventTarget(e),0!==this._InputFile.files.length?(this.readFile(this._InputFile.files),this.fileAccepted.emit(this._files),this._InputFile=null,this.preventAndStopEventPropagation(e)):this._InputFile=null}},{key:"preventAndStopEventPropagation",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"readFile",value:function(e){for(var t,n=0;n<e.length;n++){var i=e[n];try{t=new m(i,this.fileOptions,this.uploader)}catch(r){throw this.fileRejected.emit(r),new Error("Something goes wrong e: "+r.message)}t.inQueue&&this._files.push(t)}}},{key:"getEventTarget",value:function(e){return e.target}}]),e}()).\u0275fac=function(e){return new(e||F)},F.\u0275dir=r.Eb({type:F,selectors:[["","ngxFile2Select",""]],hostVars:2,hostBindings:function(e,t){1&e&&r.Ub("change",(function(e){return t.onChange(e)})),2&e&&r.Ab("role",t.role)("type",t.type)},inputs:{fileOptions:"fileOptions",uploader:"uploader"},outputs:{fileHoverStart:"fileHoverStart",fileHoverEnd:"fileHoverEnd",fileAccepted:"fileAccepted",fileRejected:"fileRejected"}}),F),D=window.FileReader,H=((x=function(){function e(t,n){_classCallCheck(this,e),this.el=t}return _createClass(e,[{key:"ngOnChanges",value:function(){var e=new D,t=this.el;if(t.nativeElement.src="data:image/svg+xml;charset=utf-8,%3Csvg xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg' viewBox%3D'0 0 200 150'%2F%3E",e.onloadend=function(){t.nativeElement.src=e.result},this.image)return e.readAsDataURL(this.image.element)}}]),e}()).\u0275fac=function(e){return new(e||x)(r.Jb(r.l),r.Jb(r.D))},x.\u0275dir=r.Eb({type:x,selectors:[["img","imgPreview",""]],inputs:{image:"image"},features:[r.xb()]}),x),j=((C=function(){function e(){_classCallCheck(this,e),this.units=["bytes","KB","MB","GB","TB","PB"]}return _createClass(e,[{key:"transform",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!isFinite(e))return"?";for(var n=0;e>=1024;)e/=1024,n++;return e.toFixed(+t)+" "+this.units[n]}}]),e}()).\u0275fac=function(e){return new(e||C)},C.\u0275pipe=r.Ib({name:"fileSize",type:C,pure:!0}),C),T=((U=function(){function e(t,n){_classCallCheck(this,e),this.el=t,this.renderer=n}return _createClass(e,[{key:"ngOnChanges",value:function(){if(this.el.nativeElement.value=this.progress.percent,this.progress.speed>0){var e=new j;this.renderer.setAttribute(this.el.nativeElement,"speedText",e.transform(this.progress.loaded))}else this.renderer.setAttribute(this.el.nativeElement,"speedText","")}}]),e}()).\u0275fac=function(e){return new(e||U)(r.Jb(r.l),r.Jb(r.D))},U.\u0275dir=r.Eb({type:U,selectors:[["progress","progressBar",""]],inputs:{progress:"progress"},features:[r.xb()]}),U),R=window.FormData,I=function(){function e(){_classCallCheck(this,e),this._id=_.uniqueID(),this.progress=new r.n,this.load=new r.n,this.error=new r.n,this.abort=new r.n,this._connections=[]}return _createClass(e,[{key:"_onLoad",value:function(e,t,n,i){var r,o,s,a,l=e.getUploader();r=e,o=t,s=n,a=i,this._isSuccessCode(n)?l._onSuccessFile(r,o,s,a):l._onErrorFile(r,o,s,a),l._onCompleteFile(e,t,n,i)}},{key:"_onError",value:function(e,t,n,i){var r=e.getUploader();r._onErrorFile(e,t,n,i),r._onCompleteFile(e,t,n,i)}},{key:"_onAbort",value:function(e,t,n,i){var r=e.getUploader();r._onErrorFile(e,t,n,i),r._onCompleteFile(e,t,n,i)}},{key:"_isSuccessCode",value:function(e){return e>=200&&e<300||304===e}},{key:"isConnected",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=this._connections[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;if(s.id===e.id)return s}}catch(a){n=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}return!1}},{key:"removeConnection",value:function(e){var t=null;for(var n in this._connections)this._connections.hasOwnProperty(n)&&(t=this._connections[n],e.id===t.id&&this._connections.splice(+n,1))}},{key:"connection",set:function(e){var t=e._file,n=e._connection;this.isConnected(t)||this._connections.push({id:t.id,connection:n})}}]),e}(),q=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}return _inherits(t,e),_createClass(t,[{key:"run",value:function(e){var t,n,i=this,r=e.getUploader(),o=_.extendValue(r.options.formData,e.options.formData),s=_.extendValue(r.options.withCredentials,e.options.withCredentials),a=_.extendValue(r.options.method,e.options.method),l=_.extendValue(r.options.url,e.options.url),u=_.extendValue(r.options.alias,e.options.alias),c=_.extendValue(r.options.headers,e.options.headers),h=(new Date).getTime(),d=0,p=0,f=null,v=new j;if(t=new XMLHttpRequest,this.connection={_file:e,_connection:t},n=new R,void 0!==o)for(var y in o)o.hasOwnProperty(y)&&n.append(y,o[y]);if(n.append(u,e.element,e.name),"number"!=typeof e.size)throw new TypeError("We need the file size.");for(var g in t.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var n=(new Date).getTime()-h;d=t.loaded-d,p=d/n*1e3,p=parseInt(p,10),f=v.transform(p);var r={total:t.total,loaded:t.loaded,percent:Math.round(t.loaded/t.total*100),speed:p,speedToText:f};i.progress.emit({_file:e,_data:r})}})),t.onreadystatechange=function(n){var o,s;4===this.readyState&&this.status>=400&&(o=r._parseHeaders(t.getAllResponseHeaders()),s=r._transformResponse(t.response,o),i.error.emit({_file:e,response:s,status:t.status,headers:o}))},t.onload=function(n){var o=r._parseHeaders(t.getAllResponseHeaders()),s=r._transformResponse(t.response,o);i.load.emit({_file:e,response:s,status:t.status,headers:o})},t.addEventListener("abort",(function(n){var o=r._parseHeaders(t.getAllResponseHeaders()),s=r._transformResponse(t.response,o);i.abort.emit({_file:e,response:s,status:t.status,headers:o})})),t.open(a,l,!0),t.withCredentials=s,c)c.hasOwnProperty(g)&&t.setRequestHeader(g,c[g]);t.send(n)}},{key:"cancel",value:function(e){var t=this.isConnected(e);t&&(t.connection.abort(),this.removeConnection(e))}}]),t}(I),B=function(e){return e.beforeAddingFile="beforeAddingFile",e.afterAddingFile="afterAddingFile",e.errorAddingFile="errorAddingFile",e.removeFile="removeFile",e.prepareUploadFile="prepareUploadFile",e.progressUploadFile="progressUploadFile",e.progressUploadSpeed="progressUploadSpeed",e.successUploadFile="successUploadFile",e.completeUploadFile="completeUploadFile",e.failedUploadFile="failedUploadFile",e.cancelUploadFile="cancelUploadFile",e.prepareUploadAll="prepareUploadAll",e.progressUploadAll="progressUploadAll",e.completeUploadAll="completeUploadAll",e}({}),M=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,e),this._type=null,this._callback=null,this._priority=null,this._type=t,this._callback=n,this._priority=+i}return _createClass(e,[{key:"type",get:function(){return this._type}},{key:"priority",get:function(){return this._priority}},{key:"callback",get:function(){return this._callback}}]),e}(),V=function(e){function t(e,n){var i;return _classCallCheck(this,t),(i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"FileUploader",e)))._subs=[],i.setProtocol(void 0===n?new q:n),i.init(),i}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){var e=this;this.destroy();var t=this.getProtocol().progress.subscribe((function(t){var n=t._file,i=t._data;b(n)&&(e._onProgressFile(n,i.percent),e._onProgressFileSpeed(n,i))}),(function(e){throw new Error(e)}));this._subs.push(t);var n=this.getProtocol().load.subscribe((function(t){var n,i,r,o,s=t._file,a=t.response,l=t.status,u=t.headers;if(b(s)){var c=s.getUploader();n=s,i=a,r=l,o=u,e.isSuccessCode(l)?c._onSuccessFile(n,i,r,o):c._onErrorFile(n,i,r,o),c._onCompleteFile(s,a,l,u)}}),(function(e){throw new Error(e)}));this._subs.push(n);var i=this.getProtocol().error.subscribe((function(e){var t=e._file,n=e.response,i=e.status,r=e.headers;if(b(t)){var o=t.getUploader();o._onErrorFile(t,n,i,r),o._onCompleteFile(t,n,i,r)}}),(function(e){throw new Error(e)}));this._subs.push(i);var r=this.getProtocol().abort.subscribe((function(e){var t=e._file,n=e.response,i=e.status,r=e.headers;if(b(t)){var o=t.getUploader();o._onCancelFile(t,n,i,r),o._onCompleteFile(t,n,i,r)}}),(function(e){throw new Error(e)}));this._subs.push(r)}},{key:"destroy",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this._subs[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){i.value.unsubscribe()}}catch(o){t=!0,n=o}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}this._subs=[]}}]),t}(function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.transferOptionsDefault={url:"",alias:"file",headers:{},filters:[],formData:[],autoUpload:!1,method:"POST",removeBySuccess:!1,enableCors:!1,withCredentials:!1,uniqueFiles:!1},this._$queue=new o.a([]),this._queue=[];var i=document.createElement("div");if(this._isHTML5=!!(File&&FormData&&FileReader),this._isDragAndDrop="draggable"in i||"ondragstart"in i&&"ondrop"in i,this._id=_.uniqueID(),this._hooks=[],!this._isHTML5)throw new Error("Your browser doesn't support HTML5. Our NgxFileUploader can't work here.");this.options=Object.assign({},this.transferOptionsDefault,n)}return _createClass(e,[{key:"bindOptions",value:function(e){this.options=Object.assign(Object.assign({},this.options),e)}},{key:"isHTML5",value:function(){return this._isHTML5}},{key:"isDragAndDrop",value:function(){return this._isDragAndDrop}},{key:"hook",value:function(e){if(-1!==this._hookExists(e))throw new Error("Hook with the Type [".concat(e.type,"] and the same callback still exists."));this._hooks.push(e),this._hooks.sort((function(e,t){return e.type===t.type?e.priority>t.priority?-1:e.priority<t.priority?1:0:e.type<t.type?-1:e.type>t.type?1:void 0}))}},{key:"removeHook",value:function(e){var t=this._hookExists(e);return t>=0&&(this._hooks.splice(t,1),!0)}},{key:"activeHooks",value:function(){return this._hooks.map((function(e){return"".concat(B[e.type],"->prio:").concat(e.priority)}))}},{key:"addFile",value:function(e){var t=!1;try{t=this.validate(e)}catch(i){t=!1}if(!t)return this._onAddFileError(e),!1;var n=this._queue;return this.options.uniqueFiles?-1===this.inQueue(e)?(this._runHook(B.beforeAddingFile,e),n.push(e),this._$queue.next(n),this._onAddFile(e),this._runHook(B.afterAddingFile,e),this.options.autoUpload&&e.upload(),!0):(this._onAddFileError(e),!1):(this._runHook(B.beforeAddingFile,e),n.push(e),this._$queue.next(n),this._onAddFile(e),this._runHook(B.afterAddingFile,e),this.options.autoUpload&&e.upload(),!0)}},{key:"removeFile",value:function(e){var t=this.inQueue(e);return-1!==t&&(this._queue.splice(t,1),this._$queue.next(this._queue),this._onRemoveFile(e),!0)}},{key:"inQueue",value:function(e){return this._queue.findIndex((function(t){return t.id===e.id||t.name+t.type+t.size===e.name+e.type+e.size}))}},{key:"addFilter",value:function(e){this._filterExists(e)||this.options.filters.push(e)}},{key:"validate",value:function(e){return!(this.options.filters.length>0)||this.options.filters.some((function(t){return t.validate(e)}))}},{key:"setProtocol",value:function(e){this._protocol=e}},{key:"getProtocol",value:function(){return this._protocol}},{key:"isSuccessCode",value:function(e){return e>=200&&e<300||304===e}},{key:"upload",value:function(){this._onBeforeUploadAll();var e=!0,t=!1,n=void 0;try{for(var i,r=this.queueObs[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;this.uploadFile(o)}}catch(s){t=!0,n=s}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"cancel",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.queueObs[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var o=i.value;this.cancelUploadFile(o)}}catch(s){t=!0,n=s}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"remove",value:function(){var e=_toConsumableArray(this.queueObs),t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;this.removeFile(s)}}catch(a){n=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"uploadFile",value:function(e){-1===this.inQueue(e)&&this.addFile(e),this._onBeforeUpload(e),this.getProtocol().run(e)}},{key:"cancelUploadFile",value:function(e){-1!==this.inQueue(e)&&(e.isUploading&&this.getProtocol().cancel(e),e.isUploading&&e._cancel())}},{key:"onAddFile",value:function(e){}},{key:"onAddFileError",value:function(e){}},{key:"onRemoveFile",value:function(e){}},{key:"onBeforeUploadAll",value:function(e){}},{key:"onBeforeUpload",value:function(e){}},{key:"onProgress",value:function(e,t){}},{key:"onProgressFile",value:function(e,t){}},{key:"onProgressFileSpeed",value:function(e,t){}},{key:"onSuccess",value:function(e,t,n,i){}},{key:"onError",value:function(e,t,n,i){}},{key:"onCancel",value:function(e,t,n,i){}},{key:"onComplete",value:function(e,t,n,i){}},{key:"onCompleteAll",value:function(e){}},{key:"_onAddFile",value:function(e){this.onAddFile(e)}},{key:"_onAddFileError",value:function(e){this._runHook(B.errorAddingFile,e),this.onAddFileError(e)}},{key:"_onRemoveFile",value:function(e){this._runHook(B.removeFile,e),this.onRemoveFile(e)}},{key:"_onBeforeUploadAll",value:function(){this._runHook(B.prepareUploadAll,this),this.onBeforeUploadAll(this)}},{key:"_onBeforeUpload",value:function(e){this._runHook(B.prepareUploadFile,e),e._onBeforeUpload(),this.onBeforeUpload(e)}},{key:"_onProgressFileSpeed",value:function(e,t){this._runHook(B.progressUploadSpeed,e,t),e._onProgressFileSpeed(t),this.onProgressFileSpeed(e,t)}},{key:"_onProgressFile",value:function(e,t){this._runHook(B.progressUploadFile,e,t),e._onProgress(t),this.onProgressFile(e,t),this._onProgress()}},{key:"_onProgress",value:function(){var e=this._queue;if(e.length>0){var t=0,n=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;a.success||a.error?t+=100:a.isUploading&&(t+=a.progress)}}catch(l){i=!0,r=l}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}t=Math.floor(t/e.length),this._runHook(B.progressUploadAll,t),this.onProgress(this,t),t>=100&&this._onCompleteAll()}}},{key:"_onSuccessFile",value:function(e,t,n,i){this._runHook(B.successUploadFile,e,t,n,i),e._onSuccess(t,n,i),this.onSuccess(e,t,n,i)}},{key:"_onErrorFile",value:function(e,t,n,i){this._runHook(B.failedUploadFile,e,t,n,i),e._onError(t,n,i),this.onError(e,t,n,i)}},{key:"_onCancelFile",value:function(e,t,n,i){this._runHook(B.cancelUploadFile,e,t,n,i),e._onError(t,n,i),this.onCancel(e,t,n,i)}},{key:"_onCompleteFile",value:function(e,t,n,i){this._runHook(B.completeUploadFile,e,t,n,i),this._onProgress(),this.onComplete(e,t,n,i)}},{key:"_onCompleteAll",value:function(){this._runHook(B.completeUploadAll,this),this.onCompleteAll(this)}},{key:"_parseHeaders",value:function(e){var t,n,i,r={};if(!e)return r;var o=e.split("\n"),s=!0,a=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var h=u.value;i=h.indexOf(":"),t=h.slice(0,i).trim().toLowerCase(),n=h.slice(i+1).trim(),t&&(r[t]=r[t]?r[t]+", "+n:n)}}catch(d){a=!0,l=d}finally{try{s||null==c.return||c.return()}finally{if(a)throw l}}return r}},{key:"_transformResponse",value:function(e,t){return e}},{key:"_runHook",value:function(e){for(var t in this._hooks)if(this._hooks.hasOwnProperty(t)){var n=this._hooks[t];if(n.type===e)switch(e){case B.beforeAddingFile:case B.prepareUploadAll:case B.prepareUploadFile:case B.afterAddingFile:case B.errorAddingFile:case B.completeUploadAll:case B.progressUploadAll:case B.removeFile:n.callback(arguments.length<=1?void 0:arguments[1]);break;case B.progressUploadFile:case B.progressUploadSpeed:n.callback(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);break;case B.cancelUploadFile:case B.successUploadFile:case B.failedUploadFile:case B.completeUploadFile:n.callback(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4]);break;default:throw new Error("hookType unknown or not defined")}}}},{key:"_hookExists",value:function(e){for(var t in this._hooks)if(this._hooks.hasOwnProperty(t)){var n=this._hooks[t];if(n.type===e.type&&""+n.callback==""+e.callback)return+t}return-1}},{key:"_filterExists",value:function(e){var t=this.options.filters,n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){if(o.value.name===e.name)return!0}}catch(a){i=!0,r=a}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return!1}},{key:"id",get:function(){return this._id}},{key:"queue$",get:function(){return this._$queue.asObservable()}},{key:"queueObs",get:function(){return this._queue}}]),e}()),$=function(e){return e.regex="regex",e.callback="callback",e}({}),L=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name";if(_classCallCheck(this,e),this._name="",this._regex=null,this._regCheck=null,this._callback=null,this._type=null,this._name=t,n instanceof RegExp)return this._type=$.regex,this._regex=n,void(this._regCheck=i);if(n instanceof Function)return this._type=$.callback,void(this._callback=n);throw new Error("FilterData is not defined.")}return _createClass(e,[{key:"validate",value:function(e){if(this._type===$.regex)return this._regexpCheck(e);if(this._type!==$.callback)throw new Error("Filter type is not defined.");return this._callback(e)}},{key:"_regexpCheck",value:function(e){var t=!1;switch(this._regCheck){case"name":t=null!=e.object.name.match(this._regex);break;case"type":t=null!=e.object.type.match(this._regex);break;case"date":var n=new v.e("en-US").transform(e.object.lastModifiedDate,"yyyy-MM-dd hh:mm:ss");n&&n.match(this._regex)&&(t=!0);break;default:throw new Error("RegExp can only check on `name | type | date`.")}return t}},{key:"name",get:function(){return this._name}},{key:"type",get:function(){return this._type}}]),e}(),z=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this)))._httpClient=e,n.ngUnsubscribe=new s.a,n}return _inherits(t,e),_createClass(t,[{key:"run",value:function(e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r,o,s,a,u,c,h,d,p,f,v,y,g,k,m,b;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.getUploader(),r=_.extendValue(i.options.formData,e.options.formData),o=_.extendValue(i.options.withCredentials,e.options.withCredentials),s=_.extendValue(i.options.method,e.options.method),a=_.extendValue(i.options.url,e.options.url),u=_.extendValue(i.options.alias,e.options.alias),c=_.extendValue(i.options.headers,e.options.headers,{"Content-Type":"multipart/form-data"}),h=(new Date).getTime(),this.connection={_file:e,_connection:null},n=new FormData,void 0===r){t.next=21;break}for(d=!0,p=!1,f=void 0,t.prev=5,v=r[Symbol.iterator]();!(d=(y=v.next()).done);d=!0)for(k in g=y.value)g.hasOwnProperty(k)&&n.append(k,g[k]);t.next=13;break;case 9:t.prev=9,t.t0=t.catch(5),p=!0,f=t.t0;case 13:t.prev=13,t.prev=14,d||null==v.return||v.return();case 16:if(t.prev=16,!p){t.next=19;break}throw f;case 19:return t.finish(16);case 20:return t.finish(13);case 21:if(n.append(u,e.element,e.name),"number"==typeof e.size){t.next=23;break}throw new TypeError("We need the file size.");case 23:return m=new l.d(s,a,n,{headers:c,reportProgress:!0,withCredentials:o}),b=this._httpClient.request(m),t.next=26,this.handleMethode(e,b,h);case 26:case"end":return t.stop()}}),t,this,[[5,9,13,21],[14,,16,20]])})))}},{key:"handleMethode",value:function(e,t,n){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var r,o,s,u,c,d,v,_,y=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=0,o=0,s=null,u=new j,i.abrupt("return",t.pipe((_=this.ngUnsubscribe,function(e){return e.lift(new h(_))}),Object(p.a)((function(t){switch(t.type){case l.c.UploadProgress:var i=(new Date).getTime()-n;r=t.loaded-r,o=r/i*1e3,o=parseInt(o,10),s=u.transform(o);var a={total:t.total,loaded:t.loaded,percent:Math.round(t.loaded/t.total*100),speed:o,speedToText:s};return y.isConnected(e)&&y.progress.emit({_file:e,_data:a}),t;case l.c.Response:return c=t.headers,d=t.body,v=t.status,y.isConnected(e)&&y.load.emit({_file:e,response:d,status:v,headers:c}),t;default:return t}})),Object(f.a)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"operation",n=arguments.length>1?arguments[1]:void 0;return function(i){return console.log("".concat(t," failed: ").concat(i.message)),y.error.emit({_file:e,response:n,status:i.status,headers:{}}),console.error(i),Object(a.a)(n)}}))).toPromise());case 3:case"end":return i.stop()}}),i,this)})))}},{key:"cancel",value:function(e){this.isConnected(e)&&(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete(),this.abort.emit({_file:e,response:{},status:999,headers:{}}),this.removeConnection(e))}}]),t}(I),Q=new r.q(null),J=((E=function(){function e(t,n){_classCallCheck(this,e),this._httpClient=t,this._config=n,this._uploadServices={},n&&n.url&&(this.registerUploadService("default",new V(n)),this.useAngularProtocol("default"))}return _createClass(e,[{key:"registerUploadService",value:function(e,t){if(null!=this._uploadServices[e])throw new Error("Upload service with the key [".concat(e,"] exists."));this._config&&t.bindOptions(Object.assign(Object.assign({},this._config),t.options)),this._uploadServices[e]={uploader:t}}},{key:"setHook",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._checkUploader(e),this._uploadServices[e].uploader.hook(new M(t,n,i))}},{key:"useAngularProtocol",value:function(e){this._checkUploader(e),this._uploadServices[e].uploader.setProtocol(new z(this._httpClient)),this._uploadServices[e].uploader.init()}},{key:"useDefaultProtocol",value:function(e){this._checkUploader(e),this._uploadServices[e].uploader.setProtocol(new q),this._uploadServices[e].uploader.init()}},{key:"getUploader",value:function(e){return this._checkUploader(e),this._uploadServices[e].uploader}},{key:"addFile",value:function(e,t){this._checkUploader(e),t.bindUploader(this._uploadServices[e].uploader)}},{key:"addFiles",value:function(e,t){this._checkUploader(e);var n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)o.value.bindUploader(this._uploadServices[e].uploader)}catch(a){i=!0,r=a}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}},{key:"startAll",value:function(e){this._checkUploader(e),this._uploadServices[e].uploader.upload()}},{key:"startFile",value:function(e,t){this._checkUploader(e),null==t.getUploader()&&t.bindUploader(this._uploadServices[e].uploader),this._uploadServices[e].uploader.uploadFile(t)}},{key:"cancelAll",value:function(e){this._checkUploader(e),this._uploadServices[e].uploader.cancel()}},{key:"cancelFile",value:function(e,t){this._checkUploader(e),this._uploadServices[e].uploader.cancelUploadFile(t)}},{key:"_checkUploader",value:function(e){if(null==this._uploadServices[e])throw new Error("Upload service with the key [".concat(e,"] doesn't exists."))}}]),e}()).\u0275fac=function(e){return new(e||E)(r.Qb(l.a),r.Qb(Q,8))},E.\u0275prov=r.Fb({token:E,factory:E.\u0275fac}),E),G=[J],N=((A=S=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:S,providers:[].concat(G,[{provide:Q,useValue:e}])}}}]),e}()).\u0275mod=r.Hb({type:A}),A.\u0275inj=r.Gb({factory:function(e){return new(e||A)},imports:[[]]}),A)}}]);